"use strict";var e=require("../../common/vendor.js");const t={setup(){let t=e.ref(null);const o=e.reactive({kw:"",searchResults:[],historyList:[]});e.onMounted((()=>{e.index.getStorageSync("kw")&&(o.historyList=JSON.parse(e.index.getStorageSync("kw")))}));const s=e.computed$1((()=>[...new Set([...o.historyList])].reverse()));return{input:function(s){clearTimeout(t),t=setTimeout((()=>{o.kw=s,async function(){if(""==o.kw)o.searchResults=[];else{const{data:t}=await e.index.$http.get("/api/public/v1/goods/qsearch",{query:o.kw});if(200!==t.meta.status)return e.index.$showMsg();o.searchResults=t.message}}()}),500)},searchData:o,gotoDetail:function(t){o.historyList.push(o.kw),e.index.setStorageSync("kw",JSON.stringify(o.historyList)),e.index.navigateTo({url:`/subpkg/goods_detail/goods_detail?goods_id=${t}`}),setTimeout((()=>{o.kw=""}),500)},history:s,clearHistory:function(){o.historyList=[],e.index.removeStorageSync("kw")},gotoGood_list:function(t){e.index.navigateTo({url:`/subpkg/good_list/good_list?query=${t}`})}}}};if(!Array){(e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-icons")+e.resolveComponent("uni-tag"))()}Math||((()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-tag/components/uni-tag/uni-tag.js"))();var o=e._export_sfc(t,[["render",function(t,o,s,i,n,a){return e.e({a:e.o(i.input),b:e.o((e=>i.searchData.kw=e)),c:e.p({focus:!0,radius:"15",placeholder:"搜索",clearButton:"auto",cancelButton:"none",modelValue:i.searchData.kw}),d:0!==i.searchData.kw.length},0!==i.searchData.kw.length?{e:e.f(i.searchData.searchResults,((t,o,s)=>({a:e.t(t.goods_name),b:"368cdb79-1-"+s,c:t.goods_id,d:e.o((e=>i.gotoDetail(t.goods_id)),t.goods_id)}))),f:e.p({type:"arrow-right",size:"16"})}:{g:e.o(i.clearHistory),h:e.p({type:"trash",size:"17"}),i:e.f(i.history,((t,o,s)=>({a:o,b:e.o((e=>i.gotoGood_list(t))),c:"368cdb79-3-"+s,d:e.p({text:t,type:"primary"})})))})}]]);wx.createPage(o);
